<!-- File: member.html -->
{% extends "base.html" %}

{% block title %}NomNom Member Area{% endblock %}

{% block content %}
    <div id="Body_1">
        <div id="Article" style="width: 100%;">
            <div id="Article_Block_3">
                <div id="Article_Block_3_For_List" style="width: 60%; position: relative; margin: 20px auto;">
                    <!-- ... (existing article list) ... -->
                </div>
                <div id="CreateButton" style="float: right; margin: 20px;">
                    <button class="btn btn-primary" onclick="window.location.href='{{ url_for('create_article') }}'">Tạo bài viết</button>
                </div>
            </div>
        </div>
    </div>

    <div id="articleList" style="margin-top: 20px; margin-left: 20px; display: flex; flex-wrap: wrap; justify-content: space-between;">
        {% for article in articles %}
            <div class="card" style="width: calc(33.33% - 20px); margin-bottom: 20px;">
                <div class="card-body">
                    <p class="card-title">{{ article.Title }}</p>
                    <p class="card-text">{{ article.Content }}</p>
                    <p class="card-text">{{ article.Descript }}</p>
                    <button class="delete-button" onclick="deleteArticle('{{ article.ID_article }}')">Xóa</button>
                    <button class="edit-button" onclick="editArticle('{{ article.ID_article }}')">Sửa</button>
                </div>
            </div>
            {% if loop.index % 3 == 0 %}
                </div><div style="display: flex; justify-content: space-between; margin-top: 20px; margin-left: 20px;">
            {% endif %}
        {% endfor %}
    </div>
    <script>
        function deleteArticle(articleId) {
            if (confirm('Bạn có chắc chắn muốn xóa bài viết này không?')) {
                // Gửi yêu cầu xóa bài viết đến máy chủ
                fetch('/delete_article/' + articleId, {
                    method: 'DELETE',
                })
                .then(response => {
                    if (response.ok) {
                        // Yêu cầu xóa thành công, làm mới trang
                        location.reload();
                    } else {
                        alert('Đã xảy ra lỗi khi xóa bài viết.');
                    }
                })
                .catch(error => {
                    console.error('Đã xảy ra lỗi:', error);
                    alert('Đã xảy ra lỗi khi xóa bài viết.');
                });
            }
        }
        function editArticle(articleId) {
                window.location.href = '/edit_article/' + articleId;
}
    </script>
{% endblock %}
